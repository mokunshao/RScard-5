<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>RScard</title>
    <link rel="stylesheet" type="text/css" href="./style.css">
    <script type="text/javascript" src="https://at.alicdn.com/t/font_451045_32zbfqegtq3t0529.js"></script>
</head>
<body>
    <!-- <div id="welcome" class="active"><div id="loading"></div></div> -->
    <div id="topNavBar" class="topNavBar clearfix">        
        <a href="#" class="logo">
            <span class="rs">RS</span><span class="card">card</span>
        </a>        
        <nav>
            <ul class="clearfix">
                <li><a href="#about">关于</a></li>
                <li><a href="#skills">技能</a></li>
                <li>
                    <a href="#works">作品</a>
                    <ul class="submenu">
                        <li>作品1</li>
                        <li>作品2</li>
                        <li>作品3</li>
                    </ul>
                </li>
                <li>
                    <a href="#">博客</a>
                    <ul class="submenu">
                        <li>博客1</li>
                        <li>博客2</li>
                        <li>博客3</li>
                    </ul>
                </li>
                <li><a href="#">日历</a></li>
                <li><a href="#">联系方式</a></li>
                <li><a href="#">其他</a></li>
            </ul>
        </nav>
    </div>

    <div class="banner"></div>

    <main>
        <div data-x class="userCard" id="about">
            <div class="pictureAndText clearfix" >
                <div class="picture">
                    <img src="./avatar.jpg" alt="avatar">
                </div>
                <div class="text">
                    <span class="hello">Hello
                        <span class="triangle"></span>
                    </span>
                    <h1>莫锟绍</h1>
                    <p>前端开发工程师</p>
                    <hr>
                    <dl class="clearfix">
                        <dt>年龄</dt>
                        <dd>18</dd>
                        <dt>所在城市</dt>
                        <dd>广州</dd>
                        <dt>邮箱</dt>
                        <dd>abc@abc.com</dd>
                        <dt>手机</dt>
                        <dd>13812345678</dd>
                    </dl>
                </div>
            </div>
            <footer class="media">
                <a href="#">
                    <svg class="icon" aria-hidden="true">
                        <use xlink:href="#icon-github"></use>
                    </svg>
                </a>
                <a href="#">
                    <svg class="icon" aria-hidden="true">
                        <use xlink:href="#icon-Ankerwebicon-"></use>
                    </svg>
                </a>
                <a href="#">
                    <svg class="icon" aria-hidden="true">
                        <use xlink:href="#icon-weibo"></use>
                    </svg>
                </a>  
            </footer>
        </div>

    <p class="buttonWrapper">
          <a class="button" href="resume.pdf" target="_blank" download >下载 PDF 简历</a>          
    </p>
    

    <div class="aboutMe">
        <p>莫锟绍，前端工程师，热爱 Web 开发。</p>
        <p>技能：前端开发，Rails 开发，Node.js 开发</p>
    </div>

    </main>

    <section data-x class="skills" id="skills">
      <h2>技能</h2>
      <ol class="clearfix">
        <li>
            <h3>HTML 5 &amp; CSS 3</h3>
            <div class="progressBar"><div class="progress" style="width: 50%"></div></div>
        </li>
        <li>
            <h3>JavaScript</h3>
            <div class="progressBar"><div class="progress" style="width: 70%"></div></div>
        </li> 
        <li>
            <h3>jQuery</h3>
            <div class="progressBar"><div class="progress" style="width: 60%"></div></div>
        </li> 
        <li>
            <h3>Vue</h3>
            <div class="progressBar"><div class="progress" style="width: 80%"></div></div>
        </li> 
        <li>
            <h3>React</h3>
            <div class="progressBar"><div class="progress" style="width: 30%"></div></div>
        </li> 
        <li>
            <h3>HTTP</h3>
            <div class="progressBar"><div class="progress" style="width: 40%"></div></div>
        </li>
      </ol>
    </section>

    <section data-x class="collection" id="works">
        <h2>作品集</h2>
        <nav>
            <ol class="clearfix">
              <li id="all">所有</li>
              <li id="frame">框架</li>
              <li id="pure">原生JS&amp;CSS</li>
            </ol>
        <div id="bar" class="status1"><div class="bar-inner"></div></div>
        </nav>



        <div class="works" style="height: 597px;">
            <div class="big" style="top: 0; left: 0;">
                <img src="img/1.jpg" alt="作品1">
            </div>
            <div class="small" style="top: 0; left:645px;">
                <img src="img/2.jpg" alt="作品2">
            </div>
            <div class="small" style="top: 312px;left: 645px;">
                <img src="img/3.jpg" alt="照片3">
            </div>
        </div>
    </section>
    <!-- 引入 tween.js-->
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tween.js/17.2.0/Tween.min.js"></script>
    <script type="text/javascript">

        // 载入动画延迟
        // setTimeout(
        //     function(){welcome.classList.remove("active");},
        //     1500
        // )

        all.onclick = function(){
            bar.className = "status1"
        }
        frame.onclick = function(){
            bar.className = "status2"
        }
        pure.onclick = function(){
            bar.className = "status3"
        }

        // 添加 offset 类
        let specialTags = document.querySelectorAll('[data-x]');
        for(let i=0;i<specialTags.length;i++){
            specialTags[i].classList.add("offset")
        }


        function findClosest(){
            let specialTags = document.querySelectorAll('[data-x]');
            let minIndex = 0;
            for(let i=1;i<specialTags.length;i++){
                if ( Math.abs(specialTags[i].offsetTop-window.scrollY)<Math.abs(specialTags[minIndex].offsetTop-window.scrollY)) {
                    minIndex=i
                }
            }

            specialTags[minIndex].classList.remove("offset")
       
            let id = specialTags[minIndex].id;
            let a = document.querySelector("a[href='#"+id+"']");
            let $li =a.parentNode;
            let liList =$li.parentNode.children;
            for (let i =0;i<liList.length;i++){
                liList[i].classList.remove("highLight")
            }
            $li.classList.add("highLight");
        }


        setTimeout(function(){
            findClosest();
        },1000) 


        window.onscroll=function(){
            if(window.scrollY>0){
                topNavBar.classList.add("sticky");
            }else{
                topNavBar.classList.remove("sticky");
            }

            findClosest();
        }



        let li = document.querySelectorAll("nav > ul > li")
        for(let i = 0; i<li.length;i++){
             li[i].onmouseenter=function(x){
                x.currentTarget.classList.add("active");
             } 
             li[i].onmouseleave=function(x){
                x.currentTarget.classList.remove("active");
             } 
        }

        // Setup the animation loop.
        function animate(time) {
            requestAnimationFrame(animate);
            TWEEN.update(time);
        }
        requestAnimationFrame(animate);

        let aTags = document.querySelectorAll("nav>ul>li>a")

        for(let i =0; i<aTags.length; i++){
            aTags[i].onclick = function(x){
                x.preventDefault();
                let a = x.currentTarget;
                let href = a.getAttribute("href");
                let element = document.querySelector(href)
                let top = element.offsetTop;
                let targetTop = top-80;
                let currentTop = window.scrollY;
                let s = targetTop-currentTop;
                
                // 方案一
                // window.scrollTo(currentTop,targetTop);
                
                // 方案二
                // let n =30; //多少个慢动作
                // let t=500/n; //多久搞一个慢动作
                // let ss =s/n; //一个慢动作的移动距离
                // let i =0;
                // let id=setInterval(()=>{
                //     if(i===n){
                //         window.clearInterval(id)
                //         return
                //     }
                //     i=i+1;
                //     window.scrollTo(currentTop,currentTop+ss*i)
                // },15)

                // 方案三
                var coords = {y: currentTop };
                var tween = new TWEEN.Tween(coords)
                .to({ y:targetTop }, 1000) 
                .easing(TWEEN.Easing.Quadratic.InOut) 
                .onUpdate(function() { 
                    window.scrollTo(currentTop,coords.y)
                })
                .start(); 

            }
        }

    </script>
</body>
</html>